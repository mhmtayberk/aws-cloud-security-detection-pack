{
    "rule_id": "secrets_manager_access",
    "title": "Secrets Manager Access from Unusual Source",
    "description": "Detects GetSecretValue calls from non-SDK sources (manual CLI, unfamiliar tools). Legitimate apps use standard SDKs. Manual access may indicate stolen credentials being used to harvest secrets.",
    "severity": "low",
    "author": "Antigravity",
    "status": "baseline_required",
    "log_source": "cloudtrail",
    "tags": [
        "aws",
        "security",
        "credential_access",
        "mitre_t1555"
    ],
    "query": {
        "logic": "AND",
        "conditions": [
            {
                "field": "eventSource",
                "operator": "==",
                "value": "secretsmanager.amazonaws.com"
            },
            {
                "field": "eventName",
                "operator": "==",
                "value": "GetSecretValue"
            },
            {
                "field": "errorCode",
                "operator": "NOT_EXISTS",
                "value": true
            },
            {
                "field": "userIdentity.type",
                "operator": "==",
                "value": "IAMUser"
            }
        ]
    },
    "tuning_guidance": "In production, add sourceIPAddress whitelist (VPN/office IPs) or whitelist automation role ARNs. Focus on IAMUser access from external IPs.",
    "false_positives": [
        "Developers using CLI for local testing",
        "CI/CD pipelines with unusual user agents"
    ],
    "recommendation": "Check sourceIPAddress. If external or unfamiliar, rotate the secret immediately and investigate the IAM user's access keys."
}